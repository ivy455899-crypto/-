<!-- æ–°å¢ï¼šå§“åèˆ‡èˆˆè¶£è¼¸å…¥å¡ç‰‡ -->
<div class="card" id="profileCard" style="margin-top:20px;">
  <h3>å»ºç«‹å€‹äººæª”æ¡ˆ</h3>
  <div class="row">
    <input id="nameInput" placeholder="è¼¸å…¥ä½ çš„å§“å" style="flex:1" />
  </div>
  <div class="row" style="margin-top:8px;">
    <input id="hobbyInput" placeholder="è¼¸å…¥ä½ çš„èˆˆè¶£" style="flex:1" />
    <button class="accent" id="submitProfile">é€å‡º</button>
  </div>
  <div id="chatArea" style="margin-top:12px; padding:10px; background:#f0f4ff; border-radius:8px; display:none;"></div>
</div>

<!-- åŠ å…¥å‹•ç•«æ¨£å¼ -->
<style>
  .fade-in {
    animation: fadeIn 0.8s ease-out forwards;
    opacity: 0;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .confetti {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 9999;
    animation: fadeOut 2s ease-in forwards;
  }

  @keyframes fadeOut {
    from { opacity: 1; }
    to { opacity: 0; }
  }
</style>

<!-- JavaScript: å§“åèˆˆè¶£äº’å‹• -->
<script>
  document.getElementById('submitProfile').addEventListener('click', () => {
    const name = document.getElementById('nameInput').value.trim();
    const hobby = document.getElementById('hobbyInput').value.trim();
    const chat = document.getElementById('chatArea');

    if (!name || !hobby) {
      alert('è«‹å¡«å¯«å§“åå’Œèˆˆè¶£ï¼');
      return;
    }

    // é¡¯ç¤ºå°è©±
    chat.style.display = 'block';
    chat.classList.add('fade-in');
    chat.innerHTML = `
      ğŸ‘‹ å—¨ï¼Œ<strong>${name}</strong>ï¼<br/>
      ğŸ‰ è½èµ·ä¾†ä½ å–œæ­¡ <strong>${hobby}</strong>ï¼ŒçœŸæœ‰è¶£ï¼<br/>
      ğŸ¥³ è®“æˆ‘å€‘ä¸€èµ·åŠ æ²¹å§ï¼
    `;

    // é‡ç½®è¼¸å…¥
    document.getElementById('nameInput').value = '';
    document.getElementById('hobbyInput').value = '';

    // åŠ å…¥ç°¡å–®çš„å‹•ç•«ï¼šç‘ç´™èŠ±
    launchConfetti();
  });

  function launchConfetti() {
    const confetti = document.createElement('div');
    confetti.className = 'confetti';
    confetti.innerHTML = 'ğŸŠğŸ‰âœ¨ğŸˆğŸ’«ğŸŠğŸ‰âœ¨ğŸˆğŸ’«';
    document.body.appendChild(confetti);
    setTimeout(() => confetti.remove(), 2000);
  }
</script>

<div class="card" id="orderBox" style="margin-top: 30px;">
  <h3>ğŸ›’ é¦™æ°›å•†å“è¨‚è³¼å–®</h3>
  <div class="row">
    <select id="productSelect" style="flex:1">
      <option value="" disabled selected>è«‹é¸æ“‡é¦™æ°›</option>
      <option value="ç«ç‘°èŠ±é¦™">ç«ç‘°èŠ±é¦™</option>
      <option value="è–°è¡£è‰">è–°è¡£è‰</option>
      <option value="å°¤åŠ åˆ©">å°¤åŠ åˆ©</option>
      <option value="æª€é¦™æœ¨">æª€é¦™æœ¨</option>
    </select>
    <input id="quantityInput" type="number" min="1" placeholder="æ•¸é‡" style="width: 80px;">
    <button id="addOrder">åŠ å…¥</button>
  </div>

  <ul id="orderList"></ul>
  <div id="totalPrice" class="small" style="margin-top: 10px; font-weight:bold;"></div>
</div>

<script>
  (() => {
    const productPrices = {
      "ç«ç‘°èŠ±é¦™": 350,
      "è–°è¡£è‰": 300,
      "å°¤åŠ åˆ©": 320,
      "æª€é¦™æœ¨": 380
    };

    const select = document.getElementById("productSelect");
    const qtyInput = document.getElementById("quantityInput");
    const addOrder = document.getElementById("addOrder");
    const orderList = document.getElementById("orderList");
    const totalDisplay = document.getElementById("totalPrice");

    let orders = [];

    function renderOrders() {
      let total = 0;
      orderList.innerHTML = orders.map((o, i) => {
        const subtotal = o.qty * o.price;
        total += subtotal;
        return `
          <li>
            <span style="flex:1">${o.name} x ${o.qty}ï¼ˆ$${o.price}/ä»¶ï¼‰</span>
            <span>$${subtotal}</span>
            <button data-i="${i}" class="delOrder">åˆª</button>
          </li>
        `;
      }).join('');

      totalDisplay.textContent = total > 0 ? `ç¸½è¨ˆï¼š$${total} å…ƒ` : '';
    }

    addOrder.addEventListener('click', () => {
      const name = select.value;
      const qty = parseInt(qtyInput.value, 10);
      if (!name || isNaN(qty) || qty <= 0) return alert("è«‹æ­£ç¢ºé¸æ“‡é¦™æ°›ä¸¦è¼¸å…¥æ•¸é‡");

      const price = productPrices[name];
      orders.push({ name, qty, price });
      qtyInput.value = '';
      select.selectedIndex = 0;
      renderOrders();
    });

    orderList.addEventListener('click', e => {
      if (e.target.classList.contains('delOrder')) {
        const i = +e.target.dataset.i;
        orders.splice(i, 1);
        renderOrders();
      }
    });
  })();
</script>
